var editor=function(){Array.prototype.diff=function(t){return this.filter(function(e){return t.indexOf(e)<0})};var o="questoes/upload";function f(){for(var e="",t=location.href.split("/"),n=0;n<t.length&&(0==n?e+=t[n]+"//":""!=t[n]&&(e+=t[n]+"/"),"index.php"!=t[n]);n++);return e}function c(e){for(var t=e.find("img"),n=[],r=0;r<t.length;r++)n.push(t[r].src);return n}return{cfg:{modules:{formula:!0,toolbar:[["bold","italic","underline","strike"],[{list:"ordered"},{list:"bullet"}],[{script:"sub"},{script:"super"}],[{indent:"-1"},{indent:"+1"}],[{color:[]},{background:[]}],[{align:[]}],["formula","image"],["clean"]]},theme:"snow"},selectLocalImage:function(){var i=this.quill,a=$('<input type="file">');a.click(),a.change(function(){var e,s,t,u,n,r=a[0].files[0];/^image\//.test(r.type)?(e=r,s=i,t=new FormData,u=new XMLHttpRequest,n=f()+o,t.append("image",e),u.open("POST",n),u.onload=function(){if(200===u.status){var e=JSON.parse(u.responseText).url;t=e,n=s,r=$(n),i=n.getSelection(),a=$(n.root.innerHTML),o=r.data("server"),l=c(a),(o=null==o?l:o).push(t),r.data("server",o),n.insertEmbed(i.index,"image",t)}var t,n,r,i,a,o,l},u.send(t)):alert("Escolha uma imagem.")})},filesSync:function(e){for(var t=f()+"questoes/deleteFile",n=$(e),r=$(e.root.innerHTML),i=n.data("server"),a=c(r),o=(i=null==i?a:i).diff(a),l=0;l<o.length;l++){var s=i.indexOf(o[l]);$.post(t,{file:o[l]}),-1<s&&i.splice(s,1)}n.data("server",i)}}}();
